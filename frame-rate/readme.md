### experiment 1
We use the arduino to press twice, at preset intervals. 
The player displays a stimulus at the first keypress, and hides it at the second keypress.
The arduino measures the time it takes from the initial keypress to display, and the overall time that the stimulus was displayed.
The player measures the time between keypressed.

The results for this experiment have the following columns:

Name            | Description
--------------- | -----------
showlatency     | The latency between the first keypress and the appearance of the stimulus (measured by arduino).
hidelatency     | The latency between the appearance of the stimulus and its dissapearance (measured by arduino).
delay           | The delay before the second keypress as set for this trial (defined in the arduino).
Player Latency  | The latency between the first and second keypress (measured by player).

Notably, we needed a version of the arduino script with some additional delay to deal with the slowness of OpenSessame
### Experiment 2: - Considering frame rate
It takes the browser several milliseconds to display visual stimuli.
This delay is caused mainly by the screen refresh rate.
We want to get an idea of how large this delay is, and see if we can reliably measure it from within the browser (ideally the player can report the exact times when stimuli are shown/hidden).

For this test we'll assume that the delay between issuing an arduino keypress and the time that it is caught by the browser is a constant.
We send two keypresses to the player, with a constant delay between them.
The player shows a stimulus in response to the first keypress and hides it in response to the second one.
We measure the time it takes to display, the time it takes to hide and the overall time that the stimulus was displayed on the arduino.
We measure the time between the keypresses in the player.
This should give us some estimate of the accuracy of presentation 
(in particular, the overall display time should be affected only by frame rate, as the keypress latency should be canceled out).

**Measurement 1** is generated by the Arduino.
It is a list of latencies from key press to stimulus presentation (plus a delay constant). We expect the delay to be at most 16ms (standard refresh rate).
**Measurement 2** is generated by the player.
It consists of the latency of the second keypress (in relation to the first), and any attempt to correct the measurement in relation to the actual display time.

How long does it take to actually present a stimulus?
How accurately does the player measure responses?


Player: Listen for PRESS:A then STIMULUS and listen for PRESS:B
Arduino: PRESS:A then listen for STIMULUS then DELAY 100 then  PRESS:B

Measure:
Player measures latency from STIMULUS to PRESS:B
Arduino measures latency from PRESS:A to STIMULUS


We expect the latency of the Arduino to be composed of [input time + time to display] and the latency in the player to be composed of [time to display + input time] (hence, they should be more or less equal).


We should check if we can improve accuracy here by accurately measuring the presentation time of the stimulus (as opposed to the presentation command).
NOTE: functionally this experiment can be combined with experiment 2


The sequence of a single trail as I see it looks something like the following:
(use https://www.draw.io/ to create a diagram)
PRESS:A
Hardware input latency 
Player input latency
STIMULUS
Wait for animation frame
Display stimulus
PRESS:B
Hardware input latency 
Player input latency
End trial


Essentially we have
the player measuring from 1b/2 to 3b 
the arduino measuring from 1a to 2b/3

Both have one cycle of hardware latency, so hopefully that cancels out, and we can work directly on improving the display latency as measured by the arduino, and measurement accuracy as measured by the difference between the arduino measurement and the player measurement.

Oddly enough, the player measurement should equal to the arduino measurement + wait for animation frame.

